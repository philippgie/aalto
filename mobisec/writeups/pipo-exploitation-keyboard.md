# Solution

## Description of the problem

The `keyboard` challenge requires to exploit an application to obtain a flag.
The application checks in intervals whether there is an update.zip file and tries to extract it in order to update the files contained in it.

## Solution

Upon decompilation with jadx I saw that the app uses the update.zip to update files. Further, I notice the Prefs strings, indicating the usage of preference files. These files are used to change the flag but also whether debug information should be printed in case the zip file cannot be unzipped. These files are protected to be only accessible by this app. However, this does not apply for the update.zip. By creating an appropaite zip file I am able to coerce the app to update its preference, most notably the debug\_mode, which will lead the app to print all its preferences on zip failures, including the flag. I create a zip file containing the relevant configuration and path traversal to set the filename `../../../../../../../../../../data/data/com.mobisec.keyboard/shared_prefs/GlobalKeyboardPrefs.xml`. Then, I wait for 12 seconds before overwriting the zip file with "abc". This way, the app has twelve seconds to update its preference such that debugging is enabled and then, when attempting to parse the zip it will cause an excepiton, resulting in the debug information being printed including the flag.

## Optional Feedback


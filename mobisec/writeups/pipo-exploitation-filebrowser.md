# Solution

## Description of the problem

The `filebrowser` challenge requires the exploitation of an application to obtain a flag.
The application provides an interface where a user is able to execute different commands, ls, du, and cat. However, cat is disabled for "security reasons". Furthermore, the app contains an addFlag button.

## Solution

Upon decompilation, I realized that there was much code. Hence, I looked at the manifest. Quickly, I saw that there were different activities that were not exported, but one, PluginActivity, was implicitly exported since it had intent filters. Only requiring the necessary permission means I would be able to launch that one. The activity is not fully implemented yet and returns a PendingIntent for the query activity. This way, I can use the PendingIntent to call the QueryActivity even though it is not exported. The QueryActivity executes the command and logs the output to a file in case debug is set in the intent. The log file is in external storage; thus, I can read it if I require external storage permissions. Now, the question was which command I wanted to run. Returning to my main object, obtaining the flag, I checked where the flag was saved. The flag is saved in encrypted form in an SQL database. Notably, the key is saved in a preference file, similar to one of the previous challenges. Now, it becomes apparent that I can use the PendingIntent to read the secret key from the preference file and the flag from the SQLite database. I have to send two intents, one reading the third line of the XML containing the secret key and one intent to read the first record from the SQLite database. I print both and use cyberchef to decrypt and obtain the flag.

## Optional Feedback

